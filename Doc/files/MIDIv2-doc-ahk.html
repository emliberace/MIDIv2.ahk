<!DOCTYPE html>

<html class="NDPage NDContentPage"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>MIDIv2.doc.ahk</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.3 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');">

<script type="text/javascript">var q = window.location.search;if (q.startsWith("?Theme=")){var t = q.slice(7);var e = t.indexOf(";");if (e != -1){  t = t.slice(0, e);  }document.documentElement.classList.add(t + "Theme")}</script>

<a name="MIDIv2"></a><a name="Topic1"></a><div class="CTopic TClass LAutoHotKey first">
 <div class="CTitle">MIDIv2</div>
</div>

<a name="MIDIv2.Copyright_notice"></a><a name="Topic3"></a><div class="CTopic TGroup LAutoHotKey">
 <div class="CTitle">Copyright notice</div>
 <div class="CBody"><p><b>Copyright ©2025 emlib</b></p><p>This program is free software: you can redistribute it and/or modify</p><p>it under the terms of the GNU General Public License as published by</p><p>the Free Software Foundation, either version 3 of the License, or</p><p>(at your option) any later version.</p><p>%break%</p><p>This program is distributed in the hope that it will be useful,</p><p>but WITHOUT ANY WARRANTY; without even the implied warranty of</p><p>MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.&nbsp; See the</p><p>GNU General Public License for more details.</p><p>You should have received a copy of the GNU General Public License (gpl-3.0.txt)</p><p>along with this program.&nbsp; If not, see <a href="https://www.gnu.org/licenses/gpl-3.0.html" target="_top">https://&#8203;www&#8203;.gnu&#8203;.org&#8203;/licenses&#8203;/gpl-3&#8203;.0&#8203;.html</a>.</p></div>
</div>

<a name="MIDIv2.Getting_started"></a><a name="Topic2"></a><div class="CTopic TGroup LAutoHotKey">
 <div class="CTitle">Getting started</div>
 <div class="CBody"><p>The MIDIv2 library grants MIDI functionality to AutoHotKey v2. All functions are conveniently wrapped in a single class.</p><p>This document contains descriptions and examples of all the properties and functions of the class.</p><p>To get started, place the MIDIv2.ahk in one of the script library paths. (See <a href="https://www.autohotkey.com/docs/v2/Scripts.htm#lib" target="_top">here</a> for more info.)</p><p>Reference the library and create an instance of the class:</p><pre class="CCode">#Include &lt;MIDIv2&gt;<br />MIDI := MIDIv2()</pre><p>From here, we are ready to open MIDI Input and Output ports for sending and receiving MIDI messages.</p><pre class="CCode"><span class="SHComment">; Get the MIDI Out device ID from helper function</span><br />myOutputName := <span class="SHString">&quot;MIDI Out&quot;</span>      <span class="SHComment">; Change this to the name of your MIDI Out port</span><br />myOutputID := GetOutputDeviceByName(myOutputName)<br /><span class="SHComment">; Open the MIDI Out port</span><br />MIDI.OpenMidiOut(myOutputID)<br /><br /><span class="SHComment">; Send a Control Change message</span><br /><span class="SHComment">; MIDI CC #7 (Volume), value 100, channel 5</span><br />MIDI.SendControlChange(<span class="SHNumber">7</span>, <span class="SHNumber">100</span>, <span class="SHNumber">5</span>)<br /><br />GetOutputDeviceByName(name) {<br />    outputDevices := MIDI.GetMidiOutDevices()<br />    Loop outputDevices.Length<br />        <span class="SHKeyword">if</span> outputDevices[A_Index] = name<br />            <span class="SHKeyword">return</span> A_Index - <span class="SHNumber">1</span><br />    MsgBox(<span class="SHString">&quot;Output device: &quot;</span> name <span class="SHString">&quot; is not available.&quot;</span>)<br />    ExitApp<br />}</pre><p><b>Note:</b> Most of the following examples in this document will assume the library has been referenced and instantiated as above.</p><p>%break%</p><p>If the objective is to send or receive MIDI to/from applications running on the same computer as the AutoHotKey script, virtual MIDI ports will be required.</p><p>A stable and simple to use option is <a href="https://www.tobias-erichsen.de/software/loopmidi.html" target="_top">loopMIDI</a> by Tobias Erichsen.&nbsp; Create one port for incoming and one for outgoing MIDI data.</p><p>%break%</p><p>For more information about AutoHotKey, please see <a href="https://www.autohotkey.com/docs/v2/" target="_top">https://&#8203;www&#8203;.autohotkey&#8203;.com&#8203;/docs&#8203;/v2&#8203;/</a></p><p>%break%</p><p>Here is a working example of a simple one octave keyboard. The &quot;+&quot; and &quot;-&quot; keys are used to change the octave up or down respectively.</p><pre class="CCode"><span class="SHComment">; One Octave Keyboard</span><br /><span class="SHComment">; Use the computer keyboard to send Note On/Off messages</span><br /><span class="SHComment">;Use the +/- keys to change octave</span><br /><br /><span class="SHComment">;  w e   t y u</span><br /><span class="SHComment">; a s d f g h j k</span><br /><br /><br />#SingleInstance force<br />#Requires AutoHotkey &gt;=<span class="SHNumber">2.0</span><br />#Include &lt;MIDIv2&gt;<br /><br /><span class="SHComment">; Create an instance of the MIDIv2 class</span><br />MIDI := MIDIv2()<br /><br /><span class="SHComment">; Get the MIDI Out device ID from helper function</span><br />myOutputName := <span class="SHString">&quot;MIDI Out&quot;</span>      <span class="SHComment">; Change this to the name of your MIDI Out port</span><br />myOutputID := GetOutputDeviceByName(myOutputName)<br /><span class="SHComment">; Open the MIDI Out port</span><br />MIDI.OpenMidiOut(myOutputID)<br /><br /><span class="SHComment">; Set default output MIDI channel to 2</span><br />MIDI.OutputChannel := <span class="SHNumber">2</span><br /><br />NOTES_IN_OCTAVE := <span class="SHNumber">12</span><br />octave := <span class="SHNumber">4</span><br /><br /><span class="SHComment">; Note On ----------------------------------------</span><br />q::<br />{<br />    Hotkey <span class="SHString">&quot;q&quot;</span>, <span class="SHString">&quot;Off&quot;</span>    <span class="SHComment">; Prevent key repeat</span><br />    <span class="SHComment">; Send a Note On message with default velocity</span><br />    <span class="SHComment">; on the default MIDI Output channel</span><br />    MIDI.SendNoteOn(<span class="SHNumber">0</span> + octave * NOTES_IN_OCTAVE)<br />}<br /><span class="SHNumber">2</span>::<br />{<br />    Hotkey <span class="SHString">&quot;2&quot;</span>, <span class="SHString">&quot;Off&quot;</span><br />    MIDI.SendNoteOn(<span class="SHNumber">1</span> + octave * NOTES_IN_OCTAVE)<br />}<br />w::<br />{<br />    Hotkey <span class="SHString">&quot;w&quot;</span>, <span class="SHString">&quot;Off&quot;</span><br />    MIDI.SendNoteOn(<span class="SHNumber">2</span> + octave * NOTES_IN_OCTAVE)<br />}<br /><span class="SHNumber">3</span>::<br />{<br />    Hotkey <span class="SHString">&quot;3&quot;</span>, <span class="SHString">&quot;Off&quot;</span><br />    MIDI.SendNoteOn(<span class="SHNumber">3</span> + octave * NOTES_IN_OCTAVE)<br />}<br />e::<br />{<br />    Hotkey <span class="SHString">&quot;e&quot;</span>, <span class="SHString">&quot;Off&quot;</span><br />    MIDI.SendNoteOn(<span class="SHNumber">4</span> + octave * NOTES_IN_OCTAVE)<br />}<br />r::<br />{<br />    Hotkey <span class="SHString">&quot;r&quot;</span>, <span class="SHString">&quot;Off&quot;</span><br />    MIDI.SendNoteOn(<span class="SHNumber">5</span> + octave * NOTES_IN_OCTAVE)<br />}<br /><span class="SHNumber">5</span>::<br />{<br />    Hotkey <span class="SHString">&quot;5&quot;</span>, <span class="SHString">&quot;Off&quot;</span><br />    MIDI.SendNoteOn(<span class="SHNumber">6</span> + octave * NOTES_IN_OCTAVE)<br />}<br />t::<br />{<br />    Hotkey <span class="SHString">&quot;t&quot;</span>, <span class="SHString">&quot;Off&quot;</span><br />    MIDI.SendNoteOn(<span class="SHNumber">7</span> + octave * NOTES_IN_OCTAVE)<br />}<br /><span class="SHNumber">6</span>::<br />{<br />    Hotkey <span class="SHString">&quot;6&quot;</span>, <span class="SHString">&quot;Off&quot;</span><br />    MIDI.SendNoteOn(<span class="SHNumber">8</span> + octave * NOTES_IN_OCTAVE)<br />}<br />y::<br />{<br />    Hotkey <span class="SHString">&quot;y&quot;</span>, <span class="SHString">&quot;Off&quot;</span><br />    MIDI.SendNoteOn(<span class="SHNumber">9</span> + octave * NOTES_IN_OCTAVE)<br />}<br /><span class="SHNumber">7</span>::<br />{<br />    Hotkey <span class="SHString">&quot;7&quot;</span>, <span class="SHString">&quot;Off&quot;</span><br />    MIDI.SendNoteOn(<span class="SHNumber">10</span> + octave * NOTES_IN_OCTAVE)<br />}<br />u::<br />{<br />    Hotkey <span class="SHString">&quot;u&quot;</span>, <span class="SHString">&quot;Off&quot;</span><br />    MIDI.SendNoteOn(<span class="SHNumber">11</span> + octave * NOTES_IN_OCTAVE)<br />}<br />i::<br />{<br />    Hotkey <span class="SHString">&quot;i&quot;</span>, <span class="SHString">&quot;Off&quot;</span><br />    MIDI.SendNoteOn(<span class="SHNumber">1</span> + octave * NOTES_IN_OCTAVE)<br />}<br /><br /><span class="SHComment">; Note Off ---------------------------------------</span><br />q Up::<br />{<br />    Hotkey <span class="SHString">&quot;q&quot;</span>, <span class="SHString">&quot;On&quot;</span><br />    MIDI.SendNoteOff(<span class="SHNumber">0</span> + octave * NOTES_IN_OCTAVE)<br />}<br /><span class="SHNumber">2</span> Up::<br />{<br />    Hotkey <span class="SHString">&quot;2&quot;</span>, <span class="SHString">&quot;On&quot;</span><br />    MIDI.SendNoteOff(<span class="SHNumber">1</span> + octave * NOTES_IN_OCTAVE)<br />}<br />w Up::<br />{<br />    Hotkey <span class="SHString">&quot;w&quot;</span>, <span class="SHString">&quot;On&quot;</span><br />    MIDI.SendNoteOff(<span class="SHNumber">2</span> + octave * NOTES_IN_OCTAVE)<br />}<br /><span class="SHNumber">3</span> Up::<br />{<br />    Hotkey <span class="SHString">&quot;3&quot;</span>, <span class="SHString">&quot;On&quot;</span><br />    MIDI.SendNoteOff(<span class="SHNumber">3</span> + octave * NOTES_IN_OCTAVE)<br />}<br />e Up::<br />{<br />    Hotkey <span class="SHString">&quot;e&quot;</span>, <span class="SHString">&quot;On&quot;</span><br />    MIDI.SendNoteOff(<span class="SHNumber">4</span> + octave * NOTES_IN_OCTAVE)<br />}<br />r Up::<br />{<br />    Hotkey <span class="SHString">&quot;r&quot;</span>, <span class="SHString">&quot;On&quot;</span><br />    MIDI.SendNoteOff(<span class="SHNumber">5</span> + octave * NOTES_IN_OCTAVE)<br />}<br /><span class="SHNumber">5</span> Up::<br />{<br />    Hotkey <span class="SHString">&quot;5&quot;</span>, <span class="SHString">&quot;On&quot;</span><br />    MIDI.SendNoteOff(<span class="SHNumber">6</span> + octave * NOTES_IN_OCTAVE)<br />}<br />t Up::<br />{<br />    Hotkey <span class="SHString">&quot;t&quot;</span>, <span class="SHString">&quot;On&quot;</span><br />    MIDI.SendNoteOff(<span class="SHNumber">7</span> + octave * NOTES_IN_OCTAVE)<br />}<br /><span class="SHNumber">6</span> Up::<br />{<br />    Hotkey <span class="SHString">&quot;6&quot;</span>, <span class="SHString">&quot;On&quot;</span><br />    MIDI.SendNoteOff(<span class="SHNumber">8</span> + octave * NOTES_IN_OCTAVE)<br />}<br />y Up::<br />{<br />    Hotkey <span class="SHString">&quot;y&quot;</span>, <span class="SHString">&quot;On&quot;</span><br />    MIDI.SendNoteOff(<span class="SHNumber">9</span> + octave * NOTES_IN_OCTAVE)<br />}<br /><span class="SHNumber">7</span> Up::<br />{<br />    Hotkey <span class="SHString">&quot;7&quot;</span>, <span class="SHString">&quot;On&quot;</span><br />    MIDI.SendNoteOff(<span class="SHNumber">10</span> + octave * NOTES_IN_OCTAVE)<br />}<br />u Up::<br />{<br />    Hotkey <span class="SHString">&quot;u&quot;</span>, <span class="SHString">&quot;On&quot;</span><br />    MIDI.SendNoteOff(<span class="SHNumber">11</span> + octave * NOTES_IN_OCTAVE)<br />}<br />i Up::<br />{<br />    Hotkey <span class="SHString">&quot;i&quot;</span>, <span class="SHString">&quot;On&quot;</span><br />    MIDI.SendNoteOff(<span class="SHNumber">12</span> + octave * NOTES_IN_OCTAVE)<br />}<br /><br /><span class="SHComment">; Change octave ----------------------------------</span><br />+::<br />{<br />    Global octave<br />    octave++<br />}<br />-::<br />{<br />    Global octave<br />    octave--<br />}<br /><br />GetOutputDeviceByName(name) {<br />    outputDevices := MIDI.GetMidiOutDevices()<br />    Loop outputDevices.Length<br />        <span class="SHKeyword">if</span> outputDevices[A_Index] = name<br />            <span class="SHKeyword">return</span> A_Index - <span class="SHNumber">1</span><br />    MsgBox(<span class="SHString">&quot;Output device: &quot;</span> name <span class="SHString">&quot; is not available.&quot;</span>)<br />    ExitApp<br />}</pre></div>
</div>

<a name="Class_Properties"></a><a name="Topic4"></a><div class="CTopic TSection LAutoHotKey">
 <div class="CTitle">Class Properties</div>
</div>

<a name="Properties"></a><a name="Topic5"></a><div class="CTopic TGroup LAutoHotKey">
 <div class="CTitle">Properties</div>
</div>

<a name="InputChannel"></a><a name="Topic8"></a><div class="CTopic TProperty LAutoHotKey">
 <div class="CTitle">InputChannel</div>
 <div class="CBody"><p>Set or Get a channel filter for the MIDI Input port</p><p>%dataType% int (Read/Write)</p><p>MIDIv2 will filter out incoming messages that are not equal to the InputChannel. Setting InputChannel to 0 allows input on all MIDI channels.</p><p>Valid range: 0-16. Default value is 0.</p><div class="CHeading">Example</div><pre class="CCode">MIDI.InputChannel := <span class="SHNumber">8</span>              <span class="SHComment">; Only allow messages on channel 8</span><br />myInputChannel := MIDI.InputChannel <span class="SHComment">; Retrieve the current input channel</span></pre></div>
</div>

<a name="OutputChannel"></a><a name="Topic78"></a><div class="CTopic TProperty LAutoHotKey">
 <div class="CTitle">OutputChannel</div>
 <div class="CBody"><p>Set or Get a default output channel</p><p>%dataType% int (Read/Write)</p><p>Many functions that send MIDI messages, such as <a href="../index.html#File:MIDIv2.doc.ahk:SendNoteOn" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,19);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sendNoteOn</a> or <a href="../index.html#File:MIDIv2.doc.ahk:SendControlChange" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,22);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sendControlChange</a>, have a MIDI Channel parameter as an optional argument.&nbsp; If the MIDI Channel argument is not entered explicitly, the default output channel will be used.</p><p>Valid range: 1-16. Default is channel 1.</p><div class="CHeading">Example</div><pre class="CCode">MIDI.OutputChannel := <span class="SHNumber">5</span><br />MIDI.SendNoteOn(<span class="SHNumber">80</span>, <span class="SHNumber">100</span>, <span class="SHNumber">1</span>) <span class="SHComment">; Send Note On (80) with velocity 100 on MIDI channel 1</span><br />MIDI.SendNoteOn(<span class="SHNumber">80</span>, <span class="SHNumber">100</span>)    <span class="SHComment">; Send Note On (80) with velocity 100 on MIDI channel 5</span></pre><div class="CHeading">See Also</div><p><a href="../index.html#File:MIDIv2.doc.ahk:SendNoteOn" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,19);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >SendNoteOn</a></p></div>
</div>

<a name="MidiThrough"></a><a name="Topic77"></a><div class="CTopic TProperty LAutoHotKey">
 <div class="CTitle">MidiThrough</div>
 <div class="CBody"><p>Set or Get MIDI Through functionality</p><p>%dataType% bool (Read/Write)</p><p>If enabled, the following MIDI messages arriving on the open Input Port will be automatically sent to the open Output Port:</p><ul><li><p>Note On</p></li><li><p>Note Off</p></li><li><p>Control Change</p></li><li><p>Program Change</p></li><li><p>Aftertouch</p></li><li><p>Poly Pressure</p></li></ul><p>A MIDI Input port and a MIDI Output port needs to be open before enabling MIDI Through.</p><div class="CHeading">Example</div><pre class="CCode">MIDI.MidiThrough := True    <span class="SHComment">; Enable MIDI Through</span></pre><div class="CHeading">See Also</div><p><a href="../index.html#File:MIDIv2.doc.ahk:OpenMidiIn" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,81);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >OpenMidiIn</a>, <a href="../index.html#File:MIDIv2.doc.ahk:Receive_MIDI" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,33);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Receive MIDI</a>, <a href="../index.html#File:MIDIv2.doc.ahk:OpenMidiOut" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,13);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >OpenMidiOut</a></p></div>
</div>

<a name="CallbackPrefix"></a><a name="Topic76"></a><div class="CTopic TProperty LAutoHotKey">
 <div class="CTitle">CallbackPrefix</div>
 <div class="CBody"><p>Set or Get a function name prefix for use in callback functions</p><p>%dataType% string (Read/Write)</p><p>Only one prefix can be used in a single class instance.&nbsp; Default is &quot;MidiIn&quot;.</p><div class="CHeading">Example</div><pre class="CCode">MsgBox(MIDI.callbackPrefix) <span class="SHComment">; Returns &quot;MidiIn&quot;</span><br />MIDI.CallbackPrefix := <span class="SHString">&quot;MidiInputCallback_&quot;</span><br />MidiInputCallback_NoteOn60(MidiEvent) {<br />    MsgBox(<span class="SHString">&quot;Note On 60`nVelocity: &quot;</span> MidiEvent.velocity)<br />}</pre><p>Changes the callback function prefix from &quot;MidiIn&quot; to &quot;MidiInputCallback_&quot; and adds a callback for a <a href="../index.html#File:MIDIv2.doc.ahk:NoteOn" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,86);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Note On</a> 60 event.</p><div class="CHeading">See Also</div><p><a href="../index.html#File:MIDIv2.doc.ahk:Receive_MIDI" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,33);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Receive MIDI</a>, <a href="../index.html#File:MIDIv2.doc.ahk:NoteOn" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,86);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >NoteOn</a></p></div>
</div>

<a name="MIDI_Ports"></a><a name="Topic9"></a><div class="CTopic TSection LAutoHotKey">
 <div class="CTitle">MIDI Ports</div>
</div>

<a name="Functions"></a><a name="Topic10"></a><div class="CTopic TGroup LAutoHotKey">
 <div class="CTitle">Functions</div>
</div>

<a name="GetMidiInDevices"></a><a name="Topic79"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">GetMidiInDevices</div>
 <div id="NDPrototype79" class="NDPrototype"><div class="PSection PPlainSection">GetMidiInDevices()</div></div>
 <div class="CBody"><p>Retrieves all available MIDI input ports</p><p>The result is returned in an array where the first array element corresponds to Device ID 0, the second to Device ID 1 and so on.</p><div class="CHeading">Parameters</div><p>None</p><div class="CHeading">Returns</div><p>A String array of all available MIDI input ports</p><div class="CHeading">Example</div><pre class="CCode">midiInDevices := MIDI.GetMidiInDevices()<br />Loop midiInDevices.Length<br />    allInDevices .= A_Index - <span class="SHNumber">1</span> <span class="SHString">&quot; - &quot;</span> midiInDevices[A_Index] <span class="SHString">&quot;`n&quot;</span><br />MsgBox(<span class="SHString">&quot;MIDI IN:`n&quot;</span> allInDevices)</pre></div>
</div>

<a name="GetMidiOutDevices"></a><a name="Topic80"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">GetMidiOutDevices</div>
 <div id="NDPrototype80" class="NDPrototype"><div class="PSection PPlainSection">GetMidiOutDevices()</div></div>
 <div class="CBody"><p>Retrieves all available MIDI output ports</p><p>The result is returned in an array where the first array element corresponds to Device ID 0, the second to Device ID 1 and so on.</p><div class="CHeading">Parameters</div><p>None</p><div class="CHeading">Returns</div><p>A String array of all available MIDI output ports</p><div class="CHeading">Example</div><pre class="CCode">midiOutDevices := MIDI.GetMidiOutDevices()<br />loop midiOutDevices.Length<br />    allOutDevices .= A_Index - <span class="SHNumber">1</span> <span class="SHString">&quot; - &quot;</span> midiOutDevices[A_Index] <span class="SHString">&quot;`n&quot;</span><br />MsgBox(<span class="SHString">&quot;MIDI OUT:`n&quot;</span> allOutDevices)</pre></div>
</div>

<a name="OpenMidiOut"></a><a name="Topic13"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">OpenMidiOut</div>
 <div id="NDPrototype13" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="4" data-NarrowColumnCount="3"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/4" style="grid-area:1/1/2/2">OpenMidiOut(</div><div class="PType InFirstParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="1/3/2/4" data-NarrowGridArea="2/2/3/3" style="grid-area:1/3/2/4">devID</div><div class="PAfterParameters" data-WideGridArea="1/4/2/5" data-NarrowGridArea="3/1/4/4" style="grid-area:1/4/2/5">)</div></div></div></div>
 <div class="CBody"><p>Opens an available MIDI port for sending messages.</p><p>Only one output port can be opened per class instance. The first port available has an ID number of 0.</p><p>You can use <a href="../index.html#File:MIDIv2.doc.ahk:GetMidiOutDevices" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,80);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >GetMidiOutDevices</a> to retrieve the device names.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">devID<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>Unique ID number of the MIDI output port</p></td></tr></table><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Open an output port with ID number 4</span><br />MIDI.OpenMidiOut(<span class="SHNumber">4</span>)</pre></div>
</div>

<a name="CloseMidiOut"></a><a name="Topic14"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">CloseMidiOut</div>
 <div id="NDPrototype14" class="NDPrototype"><div class="PSection PPlainSection">CloseMidiOut()</div></div>
 <div class="CBody"><p>Closes an open output port. If an output port is not open, CloseMidiOut has no effect.</p><div class="CHeading">Parameters</div><p>None</p></div>
</div>

<a name="OpenMidiIn"></a><a name="Topic81"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">OpenMidiIn</div>
 <div id="NDPrototype81" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="4" data-NarrowColumnCount="3"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/4" style="grid-area:1/1/2/2">OpenMidiIn(</div><div class="PType InFirstParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="1/3/2/4" data-NarrowGridArea="2/2/3/3" style="grid-area:1/3/2/4">devID</div><div class="PAfterParameters" data-WideGridArea="1/4/2/5" data-NarrowGridArea="3/1/4/4" style="grid-area:1/4/2/5">)</div></div></div></div>
 <div class="CBody"><p>Opens an available MIDI port for receiving messages.</p><p>Only one input port can be opened per class instance. The first port available has an ID number of 0.</p><p>You can use <a href="../index.html#File:MIDIv2.doc.ahk:GetMidiInDevices" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,79);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >getMidiInDevices</a> to retrieve the device names.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">devID<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>Unique ID number of the MIDI input port</p></td></tr></table><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Open an input port with ID number 6</span><br />MIDI.OpenMidiOut(<span class="SHNumber">6</span>)</pre></div>
</div>

<a name="CloseMidiIn"></a><a name="Topic16"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">CloseMidiIn</div>
 <div id="NDPrototype16" class="NDPrototype"><div class="PSection PPlainSection">CloseMidiIn()</div></div>
 <div class="CBody"><p>Closes an open input port. If an input port is not open, CloseMidiIn has no effect.</p><div class="CHeading">Parameters</div><p>None</p></div>
</div>

<a name="Send_MIDI"></a><a name="Topic75"></a><div class="CTopic TSection LAutoHotKey">
 <div class="CTitle">Send MIDI</div>
</div>

<a name="Functions(2)"></a><a name="Topic18"></a><div class="CTopic TGroup LAutoHotKey">
 <div class="CTitle">Functions</div>
</div>

<a name="SendNoteOn"></a><a name="Topic19"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">SendNoteOn</div>
 <div id="NDPrototype19" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="4" data-NarrowColumnCount="3"><div class="PBeforeParameters" data-WideGridArea="1/1/4/2" data-NarrowGridArea="1/1/2/4" style="grid-area:1/1/4/2">SendNoteOn(</div><div class="PType InFirstParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="1/3/2/4" data-NarrowGridArea="2/2/3/3" style="grid-area:1/3/2/4">noteValue,</div><div class="PType InFirstParameterColumn" data-WideGridArea="2/2/3/3" data-NarrowGridArea="3/1/4/2" style="grid-area:2/2/3/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="2/3/3/4" data-NarrowGridArea="3/2/4/3" style="grid-area:2/3/3/4">velocity,</div><div class="PType InFirstParameterColumn" data-WideGridArea="3/2/4/3" data-NarrowGridArea="4/1/5/2" style="grid-area:3/2/4/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="3/3/4/4" data-NarrowGridArea="4/2/5/3" style="grid-area:3/3/4/4">channel</div><div class="PAfterParameters NegativeLeftSpaceOnWide" data-WideGridArea="3/4/4/5" data-NarrowGridArea="5/1/6/4" style="grid-area:3/4/4/5">)</div></div></div></div>
 <div class="CBody"><p>Send a Note On message with an optional Velocity value and MIDI Channel</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">noteValue<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>0-127</p></td></tr><tr><td class="CDLEntry">velocity<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>0-127</p><p>Optional. Default value is 127.</p></td></tr><tr><td class="CDLEntry">channel<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>1-16</p><p>Optional. Default value, see <a href="../index.html#File:MIDIv2.doc.ahk:OutputChannel" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,78);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >OutputChannel</a></p></td></tr></table><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Ctrl + q</span><br />^q::<br />{<br />    <span class="SHComment">; Send a A7 (105) Note On message with</span><br />    <span class="SHComment">; velocity 100 on channel 8</span><br />    MIDI.SendNoteOn(<span class="SHNumber">105</span>, <span class="SHNumber">100</span>, <span class="SHNumber">8</span>)<br />}</pre><pre class="CCode"><span class="SHComment">; Send a C2 (36) Note On message with</span><br /><span class="SHComment">; velocity 48 on the default MIDI Out channel</span><br />MIDI.SendNoteOn(<span class="SHNumber">45</span>, <span class="SHNumber">48</span>)<br /><br /><span class="SHComment">; Send a F5 (77) Note Off message with</span><br /><span class="SHComment">; default velocity (127) on the default MIDI Out channel</span><br />MIDI.SendNoteOn(<span class="SHNumber">45</span>)</pre></div>
</div>

<a name="SendNoteOff"></a><a name="Topic20"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">SendNoteOff</div>
 <div id="NDPrototype20" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="4" data-NarrowColumnCount="3"><div class="PBeforeParameters" data-WideGridArea="1/1/4/2" data-NarrowGridArea="1/1/2/4" style="grid-area:1/1/4/2">SendNoteOff(</div><div class="PType InFirstParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="1/3/2/4" data-NarrowGridArea="2/2/3/3" style="grid-area:1/3/2/4">noteValue,</div><div class="PType InFirstParameterColumn" data-WideGridArea="2/2/3/3" data-NarrowGridArea="3/1/4/2" style="grid-area:2/2/3/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="2/3/3/4" data-NarrowGridArea="3/2/4/3" style="grid-area:2/3/3/4">velocity,</div><div class="PType InFirstParameterColumn" data-WideGridArea="3/2/4/3" data-NarrowGridArea="4/1/5/2" style="grid-area:3/2/4/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="3/3/4/4" data-NarrowGridArea="4/2/5/3" style="grid-area:3/3/4/4">channel</div><div class="PAfterParameters NegativeLeftSpaceOnWide" data-WideGridArea="3/4/4/5" data-NarrowGridArea="5/1/6/4" style="grid-area:3/4/4/5">)</div></div></div></div>
 <div class="CBody"><p>Send a Note Off message with an optional Velocity value and MIDI Channel</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">noteValue<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>0-127</p></td></tr><tr><td class="CDLEntry">velocity<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>0-127</p><p>Optional. Default value is 64.</p></td></tr><tr><td class="CDLEntry">channel<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>1-16</p><p>Optional. Default value, see <a href="../index.html#File:MIDIv2.doc.ahk:OutputChannel" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,78);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >OutputChannel</a></p></td></tr></table><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Send a C#4 (61) Note Off message</span><br /><span class="SHComment">; with velocity 100 on channel 2</span><br />MIDI.SendNoteOff(<span class="SHNumber">61</span>, <span class="SHNumber">100</span>, <span class="SHNumber">2</span>)<br /><br /><span class="SHComment">; Send a A2 (45) Note Off message with</span><br /><span class="SHComment">; velocity 20 on the default MIDI Out channel</span><br />MIDI.SendNoteOff(<span class="SHNumber">45</span>, <span class="SHNumber">20</span>)<br /><br /><span class="SHComment">; Send Note Off messages on all notes with</span><br /><span class="SHComment">; default velocity (64) on the default MIDI Out channel</span><br />Loop <span class="SHNumber">128</span> {<br />    MIDI.SendNoteOff(A_Index - <span class="SHNumber">1</span>)<br />}</pre></div>
</div>

<a name="SendPolyPressure"></a><a name="Topic21"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">SendPolyPressure</div>
 <div id="NDPrototype21" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="4" data-NarrowColumnCount="3"><div class="PBeforeParameters" data-WideGridArea="1/1/4/2" data-NarrowGridArea="1/1/2/4" style="grid-area:1/1/4/2">SendPolyPressure(</div><div class="PType InFirstParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="1/3/2/4" data-NarrowGridArea="2/2/3/3" style="grid-area:1/3/2/4">noteValue,</div><div class="PType InFirstParameterColumn" data-WideGridArea="2/2/3/3" data-NarrowGridArea="3/1/4/2" style="grid-area:2/2/3/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="2/3/3/4" data-NarrowGridArea="3/2/4/3" style="grid-area:2/3/3/4">value,</div><div class="PType InFirstParameterColumn" data-WideGridArea="3/2/4/3" data-NarrowGridArea="4/1/5/2" style="grid-area:3/2/4/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="3/3/4/4" data-NarrowGridArea="4/2/5/3" style="grid-area:3/3/4/4">channel</div><div class="PAfterParameters NegativeLeftSpaceOnWide" data-WideGridArea="3/4/4/5" data-NarrowGridArea="5/1/6/4" style="grid-area:3/4/4/5">)</div></div></div></div>
 <div class="CBody"><p>Send Poly Pressure (polyphonic aftertouch) on a specific MIDI note</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">noteValue<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>0-127</p></td></tr><tr><td class="CDLEntry">value<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>0-127, Poly Pressure value</p></td></tr><tr><td class="CDLEntry">channel<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>1-16</p><p>Optional. Default value, see <a href="../index.html#File:MIDIv2.doc.ahk:OutputChannel" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,78);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >OutputChannel</a></p></td></tr></table><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Send Poly Pressure on note G3 (55)</span><br /><span class="SHComment">; with a pressure value of 90</span><br /><span class="SHComment">; on channel 6</span><br />MIDI.SendNoteOn(<span class="SHNumber">55</span>, <span class="SHNumber">90</span>, <span class="SHNumber">6</span>)</pre></div>
</div>

<a name="SendControlChange"></a><a name="Topic22"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">SendControlChange</div>
 <div id="NDPrototype22" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="4" data-NarrowColumnCount="3"><div class="PBeforeParameters" data-WideGridArea="1/1/4/2" data-NarrowGridArea="1/1/2/4" style="grid-area:1/1/4/2">SendControlChange(</div><div class="PType InFirstParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="1/3/2/4" data-NarrowGridArea="2/2/3/3" style="grid-area:1/3/2/4">number,</div><div class="PType InFirstParameterColumn" data-WideGridArea="2/2/3/3" data-NarrowGridArea="3/1/4/2" style="grid-area:2/2/3/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="2/3/3/4" data-NarrowGridArea="3/2/4/3" style="grid-area:2/3/3/4">value,</div><div class="PType InFirstParameterColumn" data-WideGridArea="3/2/4/3" data-NarrowGridArea="4/1/5/2" style="grid-area:3/2/4/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="3/3/4/4" data-NarrowGridArea="4/2/5/3" style="grid-area:3/3/4/4">channel</div><div class="PAfterParameters" data-WideGridArea="3/4/4/5" data-NarrowGridArea="5/1/6/4" style="grid-area:3/4/4/5">)</div></div></div></div>
 <div class="CBody"><p>Send a Control Change (MIDI CC) message</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">number<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>0-127, MIDI CC number</p></td></tr><tr><td class="CDLEntry">value<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>0-127, MIDI CC value</p></td></tr><tr><td class="CDLEntry">channel<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>1-16</p><p>Optional. Default value, see <a href="../index.html#File:MIDIv2.doc.ahk:OutputChannel" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,78);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >OutputChannel</a></p></td></tr></table><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Send MIDI CC#1 (Modulation)</span><br /><span class="SHComment">; with a value of 30</span><br /><span class="SHComment">; on the default output channel</span><br />MIDI.SendControlChange(<span class="SHNumber">1</span>, <span class="SHNumber">30</span>)</pre></div>
</div>

<a name="SendProgramChange"></a><a name="Topic23"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">SendProgramChange</div>
 <div id="NDPrototype23" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="4" data-NarrowColumnCount="3"><div class="PBeforeParameters" data-WideGridArea="1/1/3/2" data-NarrowGridArea="1/1/2/4" style="grid-area:1/1/3/2">SendProgramChange(</div><div class="PType InFirstParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="1/3/2/4" data-NarrowGridArea="2/2/3/3" style="grid-area:1/3/2/4">program,</div><div class="PType InFirstParameterColumn" data-WideGridArea="2/2/3/3" data-NarrowGridArea="3/1/4/2" style="grid-area:2/2/3/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="2/3/3/4" data-NarrowGridArea="3/2/4/3" style="grid-area:2/3/3/4">channel</div><div class="PAfterParameters NegativeLeftSpaceOnWide" data-WideGridArea="2/4/3/5" data-NarrowGridArea="4/1/5/4" style="grid-area:2/4/3/5">)</div></div></div></div>
 <div class="CBody"><p>Send a Program Change message</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">program<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>0-127, Program number</p></td></tr><tr><td class="CDLEntry">channel<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>1-16</p><p>Optional. Default value, see <a href="../index.html#File:MIDIv2.doc.ahk:OutputChannel" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,78);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >OutputChannel</a></p></td></tr></table><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Send Program Change</span><br /><span class="SHComment">; with a value of 8</span><br /><span class="SHComment">; on channel 10</span><br />MIDI.SendProgramChange(<span class="SHNumber">8</span>, <span class="SHNumber">10</span>)</pre></div>
</div>

<a name="SendAftertouch"></a><a name="Topic24"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">SendAftertouch</div>
 <div id="NDPrototype24" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="4" data-NarrowColumnCount="3"><div class="PBeforeParameters" data-WideGridArea="1/1/3/2" data-NarrowGridArea="1/1/2/4" style="grid-area:1/1/3/2">SendAftertouch(</div><div class="PType InFirstParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="1/3/2/4" data-NarrowGridArea="2/2/3/3" style="grid-area:1/3/2/4">value,</div><div class="PType InFirstParameterColumn" data-WideGridArea="2/2/3/3" data-NarrowGridArea="3/1/4/2" style="grid-area:2/2/3/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="2/3/3/4" data-NarrowGridArea="3/2/4/3" style="grid-area:2/3/3/4">channel</div><div class="PAfterParameters" data-WideGridArea="2/4/3/5" data-NarrowGridArea="4/1/5/4" style="grid-area:2/4/3/5">)</div></div></div></div>
 <div class="CBody"><p>Send Aftertouch</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">value<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>0-127, Aftertouch</p></td></tr><tr><td class="CDLEntry">channel<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>1-16</p><p>Optional. Default value, see <a href="../index.html#File:MIDIv2.doc.ahk:OutputChannel" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,78);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >OutputChannel</a></p></td></tr></table><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Send Aftertouch</span><br /><span class="SHComment">; with a value of 115</span><br /><span class="SHComment">; on channel 1</span><br />MIDI.SendAftertouch(<span class="SHNumber">115</span>, <span class="SHNumber">1</span>)</pre></div>
</div>

<a name="SendPitchbend"></a><a name="Topic25"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">SendPitchbend</div>
 <div id="NDPrototype25" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="4" data-NarrowColumnCount="3"><div class="PBeforeParameters" data-WideGridArea="1/1/3/2" data-NarrowGridArea="1/1/2/4" style="grid-area:1/1/3/2">SendPitchbend(</div><div class="PType InFirstParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="1/3/2/4" data-NarrowGridArea="2/2/3/3" style="grid-area:1/3/2/4">value,</div><div class="PType InFirstParameterColumn" data-WideGridArea="2/2/3/3" data-NarrowGridArea="3/1/4/2" style="grid-area:2/2/3/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="2/3/3/4" data-NarrowGridArea="3/2/4/3" style="grid-area:2/3/3/4">channel</div><div class="PAfterParameters" data-WideGridArea="2/4/3/5" data-NarrowGridArea="4/1/5/4" style="grid-area:2/4/3/5">)</div></div></div></div>
 <div class="CBody"><p>Send Pitchbend</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">value<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>0-16383, Pitch bend</p></td></tr><tr><td class="CDLEntry">channel<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>1-16</p><p>Optional. Default value, see <a href="../index.html#File:MIDIv2.doc.ahk:OutputChannel" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,78);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >OutputChannel</a></p></td></tr></table><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Send Pitchbend</span><br /><span class="SHComment">; with a value of 8192 (center position)</span><br /><span class="SHComment">; on the default output channel</span><br />MIDI.SendPitchbend(<span class="SHNumber">8192</span>)</pre></div>
</div>

<a name="SysEx"></a><a name="Topic82"></a><div class="CTopic TSection LAutoHotKey">
 <div class="CTitle">SysEx</div>
 <div class="CBody"><p>SysEx messages can be sent and received using MIDIv2.</p><p>Incoming and outgoing SysEx messages are buffered and have a maximum size of 64000 bytes. (The MIDI device driver might limit this size further.)</p><p>Each message requires a start byte of 0xF0 and an end byte of 0xF7. Bytes in between are limited to 7 bits.</p><p>In addition to sending and receiving SysEx messages, the MIDIv2 class also offers a few functions for converting data to and from the SysEx format.</p><p>SysEx messages are sent as a space delimited string of hexadecimals.</p><pre class="CCode">SysExMessage := <span class="SHString">&quot;F0 48 65 6C 6C 6F 20 77 6F 72 6C 64 21 F7&quot;</span></pre><p>For more information about SysEx messages, see <a href="https://midi.org/midi-1-0-universal-system-exclusive-messages" target="_top">https://&#8203;midi&#8203;.org&#8203;/midi-1-0-universal-system-exclusive&#8203;-messages</a></p></div>
</div>

<a name="Functions(3)"></a><a name="Topic27"></a><div class="CTopic TGroup LAutoHotKey">
 <div class="CTitle">Functions</div>
</div>

<a name="SendSysEx"></a><a name="Topic28"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">SendSysEx</div>
 <div id="NDPrototype28" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="4" data-NarrowColumnCount="3"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/4" style="grid-area:1/1/2/2">SendSysEx(</div><div class="PType InFirstParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3"><span class="SHKeyword">string</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="1/3/2/4" data-NarrowGridArea="2/2/3/3" style="grid-area:1/3/2/4">sysExString</div><div class="PAfterParameters" data-WideGridArea="1/4/2/5" data-NarrowGridArea="3/1/4/4" style="grid-area:1/4/2/5">)</div></div></div></div>
 <div class="CBody"><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">sysexString<div class="CDLParameterType"><span class="SHKeyword">string</span></div></td><td class="CDLDefinition"><p>Full SysEx message</p></td></tr></table><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Construct the SysEx message</span><br />SysExMessage := <span class="SHString">&quot;F0 48 65 6C 6C 6F 20 77 6F 72 6C 64 21 F7&quot;</span><br /><span class="SHComment">; Send message</span><br />MIDI.SendSysEx(SysExMessage)</pre></div>
</div>

<a name="ArrayHexToSysEx"></a><a name="Topic83"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">ArrayHexToSysEx</div>
 <div id="NDPrototype83" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="4" data-NarrowColumnCount="3"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/4" style="grid-area:1/1/2/2">ArrayHexToSysEx(</div><div class="PType InFirstParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3"><span class="SHKeyword">string</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="1/3/2/4" data-NarrowGridArea="2/2/3/3" style="grid-area:1/3/2/4">arr[]</div><div class="PAfterParameters" data-WideGridArea="1/4/2/5" data-NarrowGridArea="3/1/4/4" style="grid-area:1/4/2/5">)</div></div></div></div>
 <div class="CBody"><p>Converts an array of hexadecimal numbers to a SysEx string</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">arr<div class="CDLParameterType"><span class="SHKeyword">string</span>[]</div></td><td class="CDLDefinition"><p>Array of string. Each element formatted as a hexadecimal number.</p></td></tr></table><div class="CHeading">Returns</div><p>A string formatted as a SysEx message. Hexadecimal, space delimited.</p><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Array of hexadecimal numbers</span><br />SysExArray := [<span class="SHString">&quot;F0&quot;</span>, <span class="SHString">&quot;48&quot;</span>, <span class="SHString">&quot;65&quot;</span>, <span class="SHString">&quot;6C&quot;</span>, <span class="SHString">&quot;6C&quot;</span>, <span class="SHString">&quot;6F&quot;</span>, <span class="SHString">&quot;20&quot;</span>, <span class="SHString">&quot;77&quot;</span>, <span class="SHString">&quot;6F&quot;</span>, <span class="SHString">&quot;72&quot;</span>, <span class="SHString">&quot;6C&quot;</span>, <span class="SHString">&quot;64&quot;</span>, <span class="SHString">&quot;21&quot;</span>, <span class="SHString">&quot;F7&quot;</span>]<br /><br /><span class="SHComment">; Convert array</span><br />SysExMessage := MIDI.ArrayHexToSysEx(SysExArray)    <span class="SHComment">; Returns: &quot;F0 48 65 6C 6C 6F 20 77 6F 72 6C 64 21 F7&quot;</span><br /><br /><span class="SHComment">; Send message</span><br />MIDI.SendSysEx(SysExMessage)</pre></div>
</div>

<a name="ArrayDecToSysEx"></a><a name="Topic84"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">ArrayDecToSysEx</div>
 <div id="NDPrototype84" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="4" data-NarrowColumnCount="3"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/4" style="grid-area:1/1/2/2">ArrayDecToSysEx(</div><div class="PType InFirstParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3"><span class="SHKeyword">int</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="1/3/2/4" data-NarrowGridArea="2/2/3/3" style="grid-area:1/3/2/4">arr[]</div><div class="PAfterParameters" data-WideGridArea="1/4/2/5" data-NarrowGridArea="3/1/4/4" style="grid-area:1/4/2/5">)</div></div></div></div>
 <div class="CBody"><p>Converts an array of decimal numbers to a SysEx string</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">arr<div class="CDLParameterType"><span class="SHKeyword">int</span>[]</div></td><td class="CDLDefinition"><p>Array of integers. Each element formatted as a hexadecimal number.</p></td></tr></table><div class="CHeading">Returns</div><p>A string formatted as a SysEx message. Hexadecimal, space delimited.</p><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Array of decimal numbers</span><br />SysExArray := [<span class="SHNumber">240</span>, <span class="SHNumber">72</span>, <span class="SHNumber">101</span>, <span class="SHNumber">108</span>, <span class="SHNumber">108</span>, <span class="SHNumber">111</span>, <span class="SHNumber">247</span>]<br /><br /><span class="SHComment">; Convert array</span><br />SysExMessage := MIDI.ArrayDecToSysEx(SysExArray)    <span class="SHComment">; Returns: &quot;F0 48 65 6C 6C 6F F7&quot;</span><br /><br /><span class="SHComment">; Send message</span><br />MIDI.SendSysEx(SysExMessage)</pre></div>
</div>

<a name="TextToSysEx"></a><a name="Topic85"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">TextToSysEx</div>
 <div id="NDPrototype85" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="4" data-NarrowColumnCount="3"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/4" style="grid-area:1/1/2/2">TextToSysEx(</div><div class="PType InFirstParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3"><span class="SHKeyword">string</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="1/3/2/4" data-NarrowGridArea="2/2/3/3" style="grid-area:1/3/2/4">str</div><div class="PAfterParameters" data-WideGridArea="1/4/2/5" data-NarrowGridArea="3/1/4/4" style="grid-area:1/4/2/5">)</div></div></div></div>
 <div class="CBody"><p>Converts an ASCII encoded text string to a SysEx format</p><p>Note that only the first 127 ASCII characters are permitted.</p><p>If a larger character map is required, such as ANSI or UTF-8, custom SysEx messages will have to be composed manually.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">str<div class="CDLParameterType"><span class="SHKeyword">string</span></div></td><td class="CDLDefinition"><p>Text string</p></td></tr></table><div class="CHeading">Returns</div><p>A string formatted as a SysEx message. Hexadecimal, space delimited.</p><p>(Start and end bytes (0xF0 and 0xF7) are not automatically added.)</p><div class="CHeading">Example</div><pre class="CCode">myText := <span class="SHString">&quot;Hello there!&quot;</span><br /><span class="SHComment">; Convert to SysEx</span><br />SysExMessage := <span class="SHString">&quot;F0 &quot;</span> MIDI.TextToSysEx(myText) <span class="SHString">&quot; F7&quot;</span></pre><div class="CHeading">See Also</div><p><a href="../index.html#File:MIDIv2.doc.ahk:SendSysEx" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,28);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >SendSysEx</a></p></div>
</div>

<a name="SysExToText"></a><a name="Topic32"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">SysExToText</div>
 <div id="NDPrototype32" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="4" data-NarrowColumnCount="3"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/4" style="grid-area:1/1/2/2">SysExToText(</div><div class="PType InFirstParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3"><span class="SHKeyword">string</span>&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="1/3/2/4" data-NarrowGridArea="2/2/3/3" style="grid-area:1/3/2/4">sysEx</div><div class="PAfterParameters" data-WideGridArea="1/4/2/5" data-NarrowGridArea="3/1/4/4" style="grid-area:1/4/2/5">)</div></div></div></div>
 <div class="CBody"><p>Converts a SysEx message to an ASCII encoded text string</p><p>Note that each byte in the SysEx message is interpreted as a 7-bit ASCII character.&nbsp; If a larger character map is required, such as ANSI or UTF-8, custom SysEx messages will have to be interpreted manually.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">sysEx<div class="CDLParameterType"><span class="SHKeyword">string</span></div></td><td class="CDLDefinition"><p>SysEx message</p></td></tr></table><div class="CHeading">Returns</div><p>An ASCII encoded string.&nbsp; The start and end bytes of 0xF0 and 0xF7 respectively are ignored if present.</p><div class="CHeading">Example</div><pre class="CCode">MidiInSysEx(sysExEvent) {<br />    txt := MIDI.SysExToString(SysExEvent.<span class="SHKeyword">string</span>)<br />    MsgBox(<span class="SHString">&quot;SysEx message (string):`n&quot;</span> . txt)<br />}</pre><div class="CHeading">See Also</div><p><a href="../index.html#File:MIDIv2.doc.ahk:SysEx(2)" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,89);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >SysEx(SysExEvent)</a></p></div>
</div>

<a name="Receive_MIDI"></a><a name="Topic33"></a><div class="CTopic TSection LAutoHotKey">
 <div class="CTitle">Receive MIDI</div>
 <div class="CBody"><p>When a MIDI message is received by the port opened with <a href="../index.html#File:MIDIv2.doc.ahk:OpenMidiIn" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,81);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >OpenMidiIn</a>, a corresponding event handler (callback function) is triggered.</p><p>These event handlers are automatically managed by the MIDIv2 class, but users need to define their own callback functions to handle the specific MIDI events. For example, create a function named MidiInNoteOn(midiEvent) to handle &quot;Note On&quot; messages.</p><p>The naming convention for these callback functions combines the user-defined <a href="../index.html#File:MIDIv2.doc.ahk:CallbackPrefix" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,76);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >CallbackPrefix</a> parameter with the MIDI message type. If CallbackPrefix is not specified, the default prefix is &quot;MidiIn&quot;.</p><div class="CHeading">MIDI message types</div><ul><li><p>NoteOn¹</p></li><li><p>NoteOff¹</p></li><li><p>PolyPressure¹</p></li><li><p>ControlChange¹</p></li><li><p>ProgramChange</p></li><li><p>Aftertouch</p></li><li><p>Pitchbend</p></li><li><p>SysEx</p></li></ul><p>¹ These types can be optionally defined with a number directly following the type.</p><p>For example ControlChange will trigger on any CC number whereas ControlChange7 will only trigger on Control number 7 (Volume).</p><p>All callbacks must be defined with one argument. This argument is an object with properties relevant to the specific MIDI message.</p></div>
</div>

<a name="Callbacks"></a><a name="Topic34"></a><div class="CTopic TGroup LAutoHotKey">
 <div class="CTitle">Callbacks</div>
</div>

<a name="NoteOn"></a><a name="Topic86"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">NoteOn[n]</div>
 <div id="NDPrototype86" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="3" data-NarrowColumnCount="2"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/3" style="grid-area:1/1/2/2">NoteOn[n](</div><div class="PName InFirstParameterColumn InLastParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3">midiEvent</div><div class="PAfterParameters" data-WideGridArea="1/3/2/4" data-NarrowGridArea="3/1/4/3" style="grid-area:1/3/2/4">)</div></div></div></div>
 <div class="CBody"><p>MIDI Note On message</p><p>An incoming Note On message has two types of callbacks. One for the specific note value and one for all Note On messages.</p><div class="CHeading">midiEvent</div><table class="CDefinitionList"><tr><td class="CDLEntry">EventType</td><td class="CDLDefinition"><p>Equal to &quot;NoteOn&quot;</p></td></tr><tr><td class="CDLEntry">Channel</td><td class="CDLDefinition"><p>(1-16) MIDI channel the event is received on</p></td></tr><tr><td class="CDLEntry">NoteNumber</td><td class="CDLDefinition"><p>(0-127) MIDI Note number</p></td></tr><tr><td class="CDLEntry">Velocity</td><td class="CDLDefinition"><p>(0-127) Note On velocity</p></td></tr></table><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Default prefix is &quot;MidiIn&quot;</span><br />MidiInNoteOn55(midiEvent) {<br />    MsgBox(<span class="SHString">&quot;G5 Note On triggered!&quot;</span>)<br />}<br /><br /><span class="SHComment">; Capture all Note On events</span><br />MidiInNoteOn(midiEvent) {<br />    note := midiEvent.NoteNumber<br />    velocity := midiEvent.Velocity<br />    channel := midiEvent.Channel<br />    MsgBox(<span class="SHString">&quot;NOTE ON`nNote: &quot;</span> note <span class="SHString">&quot;`nVelocity: &quot;</span> velocity <span class="SHString">&quot;`nChannel: &quot;</span> channel)<br />}</pre></div>
</div>

<a name="NoteOff"></a><a name="Topic87"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">NoteOff[n]</div>
 <div id="NDPrototype87" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="3" data-NarrowColumnCount="2"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/3" style="grid-area:1/1/2/2">NoteOff[n](</div><div class="PName InFirstParameterColumn InLastParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3">midiEvent</div><div class="PAfterParameters" data-WideGridArea="1/3/2/4" data-NarrowGridArea="3/1/4/3" style="grid-area:1/3/2/4">)</div></div></div></div>
 <div class="CBody"><p>MIDI Note Off message</p><p>An incoming Note Off message has two types of callbacks. One for the specific note value and one for all Note Off messages.</p><div class="CHeading">midiEvent</div><table class="CDefinitionList"><tr><td class="CDLEntry">EventType</td><td class="CDLDefinition"><p>Equal to &quot;NoteOff&quot;</p></td></tr><tr><td class="CDLEntry">Channel</td><td class="CDLDefinition"><p>(1-16) MIDI channel the event is received on</p></td></tr><tr><td class="CDLEntry">NoteNumber</td><td class="CDLDefinition"><p>(0-127) MIDI Note number</p></td></tr><tr><td class="CDLEntry">Velocity</td><td class="CDLDefinition"><p>(0-127) Note Off velocity</p></td></tr></table></div>
</div>

<a name="PolyPressure"></a><a name="Topic88"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">PolyPressure[n]</div>
 <div id="NDPrototype88" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="3" data-NarrowColumnCount="2"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/3" style="grid-area:1/1/2/2">PolyPressure[n](</div><div class="PName InFirstParameterColumn InLastParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3">midiEvent</div><div class="PAfterParameters" data-WideGridArea="1/3/2/4" data-NarrowGridArea="3/1/4/3" style="grid-area:1/3/2/4">)</div></div></div></div>
 <div class="CBody"><p>MIDI Poly Pressure message</p><p>An incoming Poly Pressure message has two types of callbacks. One for the specific note number and one for all Poly Pressure messages.</p><div class="CHeading">midiEvent</div><table class="CDefinitionList"><tr><td class="CDLEntry">EventType</td><td class="CDLDefinition"><p>Equal to &quot;PolyPressure&quot;</p></td></tr><tr><td class="CDLEntry">Channel</td><td class="CDLDefinition"><p>(1-16) MIDI channel the event is received on</p></td></tr><tr><td class="CDLEntry">NoteNumber</td><td class="CDLDefinition"><p>(0-127) MIDI Note number</p></td></tr><tr><td class="CDLEntry">Pressure</td><td class="CDLDefinition"><p>(0-127) Pressure Value</p></td></tr></table><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Receive Poly Pressure for middle C (note #60)</span><br />MidiInPolyPressure60(midiEvent) {<br />    msg := <span class="SHString">&quot;Poly Pressure on C4 is: &quot;</span> midiEvent.Pressure<br />    msg .= <span class="SHString">&quot;`nMessage received on channel: &quot;</span> midiEvent.Channel<br />    MsgBox(msg)<br />}</pre></div>
</div>

<a name="ControlChange"></a><a name="Topic38"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">ControlChange[n]</div>
 <div id="NDPrototype38" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="3" data-NarrowColumnCount="2"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/3" style="grid-area:1/1/2/2">ControlChange[n](</div><div class="PName InFirstParameterColumn InLastParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3">midiEvent</div><div class="PAfterParameters" data-WideGridArea="1/3/2/4" data-NarrowGridArea="3/1/4/3" style="grid-area:1/3/2/4">)</div></div></div></div>
 <div class="CBody"><p>MIDI Control Change message</p><p>An incoming Control Change message has two types of callbacks. One for the specific controller number and one for all Control Change messages.</p><div class="CHeading">midiEvent</div><table class="CDefinitionList"><tr><td class="CDLEntry">EventType</td><td class="CDLDefinition"><p>Equal to &quot;ControlChange&quot;</p></td></tr><tr><td class="CDLEntry">Channel</td><td class="CDLDefinition"><p>(1-16) MIDI channel the event is received on</p></td></tr><tr><td class="CDLEntry">Controller</td><td class="CDLDefinition"><p>(0-127) Controller Number</p></td></tr><tr><td class="CDLEntry">Value</td><td class="CDLDefinition"><p>(0-127) Controller Value</p></td></tr></table><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Receive Modulation Wheel message</span><br />MidiInControlChange1(midiEvent) {<br />    MsgBox(<span class="SHString">&quot;Mod Wheel value is: &quot;</span> midiEvent.Value)<br />}</pre></div>
</div>

<a name="ProgramChange"></a><a name="Topic39"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">ProgramChange</div>
 <div id="NDPrototype39" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="3" data-NarrowColumnCount="2"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/3" style="grid-area:1/1/2/2">ProgramChange(</div><div class="PName InFirstParameterColumn InLastParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3">midiEvent</div><div class="PAfterParameters" data-WideGridArea="1/3/2/4" data-NarrowGridArea="3/1/4/3" style="grid-area:1/3/2/4">)</div></div></div></div>
 <div class="CBody"><p>MIDI Program Change message</p><div class="CHeading">midiEvent</div><table class="CDefinitionList"><tr><td class="CDLEntry">EventType</td><td class="CDLDefinition"><p>Equal to &quot;ProgramChange&quot;</p></td></tr><tr><td class="CDLEntry">Channel</td><td class="CDLDefinition"><p>(1-16) MIDI channel the event is received on</p></td></tr><tr><td class="CDLEntry">Program</td><td class="CDLDefinition"><p>(0-127) Program Number</p></td></tr></table><div class="CHeading">Example</div><pre class="CCode">MidiInProgramChange(midiEvent) {<br />    channel := midiEvent.Channel<br />    program := midiEvent.Program<br />    MsgBox(<span class="SHString">&quot;Program Change: &quot;</span> program <span class="SHString">&quot;`nOn channel: &quot;</span> channel)<br />}</pre></div>
</div>

<a name="Aftertouch"></a><a name="Topic40"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">Aftertouch</div>
 <div id="NDPrototype40" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="3" data-NarrowColumnCount="2"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/3" style="grid-area:1/1/2/2">Aftertouch(</div><div class="PName InFirstParameterColumn InLastParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3">midiEvent</div><div class="PAfterParameters" data-WideGridArea="1/3/2/4" data-NarrowGridArea="3/1/4/3" style="grid-area:1/3/2/4">)</div></div></div></div>
 <div class="CBody"><p>MIDI Aftertouch message</p><div class="CHeading">midiEvent</div><table class="CDefinitionList"><tr><td class="CDLEntry">EventType</td><td class="CDLDefinition"><p>Equal to &quot;Aftertouch&quot;</p></td></tr><tr><td class="CDLEntry">Channel</td><td class="CDLDefinition"><p>(1-16) MIDI channel the event is received on</p></td></tr><tr><td class="CDLEntry">Pressure</td><td class="CDLDefinition"><p>(0-127) Aftertouch pressure value</p></td></tr></table><div class="CHeading">Example</div><pre class="CCode">MidiInAftertouch(midiEvent) {<br />    channel := midiEvent.Channel<br />    pressure := midiEvent.Pressure<br />    MsgBox(<span class="SHString">&quot;Aftertouch: &quot;</span> pressure <span class="SHString">&quot;`nOn channel: &quot;</span> channel)<br />}</pre></div>
</div>

<a name="Pitchbend"></a><a name="Topic41"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">Pitchbend</div>
 <div id="NDPrototype41" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="3" data-NarrowColumnCount="2"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/3" style="grid-area:1/1/2/2">Pitchbend(</div><div class="PName InFirstParameterColumn InLastParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3">midiEvent</div><div class="PAfterParameters" data-WideGridArea="1/3/2/4" data-NarrowGridArea="3/1/4/3" style="grid-area:1/3/2/4">)</div></div></div></div>
 <div class="CBody"><p>MIDI Pitchbend message</p><div class="CHeading">midiEvent</div><table class="CDefinitionList"><tr><td class="CDLEntry">EventType</td><td class="CDLDefinition"><p>Equal to &quot;Pitchbend&quot;</p></td></tr><tr><td class="CDLEntry">Channel</td><td class="CDLDefinition"><p>(1-16) MIDI channel the event is received on</p></td></tr><tr><td class="CDLEntry">PitchBend</td><td class="CDLDefinition"><p>(0-16383) Pitchbend value</p></td></tr></table><div class="CHeading">Example</div><pre class="CCode">MidiInPitchbend(midiEvent) {<br />    MsgBox(midiEvent.EventType <span class="SHString">&quot;: &quot;</span> midiEvent.PitchBend)<br />}</pre></div>
</div>

<a name="SysEx(2)"></a><a name="Topic89"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">SysEx</div>
 <div id="NDPrototype89" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="3" data-NarrowColumnCount="2"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/3" style="grid-area:1/1/2/2">SysEx(</div><div class="PName InFirstParameterColumn InLastParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3">sysExEvent</div><div class="PAfterParameters" data-WideGridArea="1/3/2/4" data-NarrowGridArea="3/1/4/3" style="grid-area:1/3/2/4">)</div></div></div></div>
 <div class="CBody"><p>MIDI SysEx messages</p><div class="CHeading">sysExEvent</div><table class="CDefinitionList"><tr><td class="CDLEntry">ArrHex</td><td class="CDLDefinition"><p>Array of each SysEx byte formatted as hexadecimal</p><p>(First element is &quot;F0&quot; and the last is &quot;F7&quot;)</p></td></tr><tr><td class="CDLEntry">ArrDec</td><td class="CDLDefinition"><p>Array of each SysEx byte formatted as decimal integer</p></td></tr><tr><td class="CDLEntry">String</td><td class="CDLDefinition"><p>SysEx message as one string, space delimited</p></td></tr><tr><td class="CDLEntry">Size</td><td class="CDLDefinition"><p>Total number of bytes in the message</p></td></tr></table><div class="CHeading">Example</div><pre class="CCode">MidiInSysEx(sysExEvent) {<br />    <span class="SHComment">; Convert message to text</span><br />    SysEx_Text := MIDI.SysExToText(sysExEvent.String)<br />    MsgBox(<span class="SHString">&quot;SysEx message:`n&quot;</span> . SysEx_Text)<br />}</pre><pre class="CCode">MidiInSysEx(sysExEvent) {<br />    <span class="SHComment">; Act on specific bytes within the message</span><br />    For _, hex <span class="SHKeyword">in</span> sysExEvent.ArrHex {<br />        Switch hex, <span class="SHNumber">0</span> {<br />            Case <span class="SHString">&quot;30&quot;</span>:<br />                <span class="SHComment">; 0x30</span><br />            Case <span class="SHString">&quot;3A&quot;</span>:<br />                <span class="SHComment">; 0x3A</span><br />            Case <span class="SHString">&quot;F0&quot;</span>, <span class="SHString">&quot;F7&quot;</span>:<br />                <span class="SHComment">; SysEx start/end byte</span><br />        }<br />    }<br />}</pre><pre class="CCode">MidiInSysEx(sysExEvent) {<br />    MsgBox(<span class="SHString">&quot;Fist message byte: &quot;</span> . sysExEvent.Array[<span class="SHNumber">2</span>])<br /><br />    SysEx_Size := sysExEvent.Size <span class="SHComment">; Number of bytes in the message</span><br />    MsgBox(<span class="SHString">&quot;Last message byte: &quot;</span> . sysExEvent.array[SysEx_Size - <span class="SHNumber">1</span>])<br />}</pre><p>See Also: <a href="../index.html#File:MIDIv2.doc.ahk:SysExToText" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,32);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >SysExToText</a></p></div>
</div>

<a name="MMC_MTC"></a><a name="Topic43"></a><div class="CTopic TSection LAutoHotKey">
 <div class="CTitle">MMC &amp; MTC</div>
 <div class="CBody"><p>MIDI Machine Control and MIDI Time Code</p><p>MIDIv2 comes with predefined functions and callbacks for basic MIDI Machine Control, Machine Control Response and MIDI Time Code.&nbsp; Several commands (MCS, MCP) have been excluded from MIDIv2 due to being specialty and/or legacy in today's digital world.&nbsp; For more advanced handling of MMC or MTC, messages can always be manually created and sent with the <a href="../index.html#File:MIDIv2.doc.ahk:SendSysEx" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,28);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >sendSysEx</a> function and responses can be received via the <a href="../index.html#File:MIDIv2.doc.ahk:SysEx(2)" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,89);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >SysEx(sysExEvent)</a> callback.</p><p>By default, MCR (Machine Control Response) and MTC callbacks are disabled and must be enabled with the class properties <a href="../index.html#File:MIDIv2.doc.ahk:MMC_enabled" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,45);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MMC_enabled</a> and <a href="../index.html#File:MIDIv2.doc.ahk:TC_enabled" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,46);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >TC_enabled</a>.</p><p>%break%</p><p>For more information about MMC, see the <b>MIDI Machine Control Specification</b> document available for download at <a href="https://midi.org" target="_top">https://&#8203;midi&#8203;.org</a></p></div>
</div>

<a name="Properties(2)"></a><a name="Topic44"></a><div class="CTopic TGroup LAutoHotKey">
 <div class="CTitle">Properties</div>
</div>

<a name="MMC_enabled"></a><a name="Topic45"></a><div class="CTopic TProperty LAutoHotKey">
 <div class="CTitle">MMC_enabled</div>
 <div class="CBody"><p>Set or get support for Machine Control callbacks.</p><p>%dataType% bool (Read/Write)</p><div class="CHeading">Example</div><pre class="CCode">MIDI.MMC_Enabled := True</pre><div class="CHeading">See Also</div><p><a href="../index.html#File:MIDIv2.doc.ahk:Callbacks(2)" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,60);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Callbacks  [2]</a></p></div>
</div>

<a name="TC_enabled"></a><a name="Topic46"></a><div class="CTopic TProperty LAutoHotKey">
 <div class="CTitle">TC_enabled</div>
 <div class="CBody"><p>Set or get support for Time Code callbacks.</p><p>%dataType% bool (Read/Write)</p><div class="CHeading">Example</div><pre class="CCode">MIDI.TC_Enabled := True</pre><div class="CHeading">See Also</div><p><a href="../index.html#File:MIDIv2.doc.ahk:Callbacks(2)" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,60);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Callbacks  [2]</a></p></div>
</div>

<a name="MMC_deviceID"></a><a name="Topic90"></a><div class="CTopic TProperty LAutoHotKey">
 <div class="CTitle">MMC_deviceID</div>
 <div class="CBody"><p>Set or Get the Device ID used to send and receive MMC/MCR data</p><p>%dataType% int (Read/Write)</p><p>Device ID is the communication address used to send and receive MMC/MCR data.&nbsp; A value of 1-126 denotes a single, unique ID whereas 127 (0x7F) is used to send and receive to all devices.&nbsp; Default value is 127 (0x7F). The partner device must be set to the same ID unless 0x7F is used.</p><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Set Device ID to a single &quot;channel&quot; (32)</span><br />MIDI.MMC_DeviceID := <span class="SHNumber">0x20</span></pre></div>
</div>

<a name="Functions(4)"></a><a name="Topic48"></a><div class="CTopic TGroup LAutoHotKey">
 <div class="CTitle">Functions</div>
</div>

<a name="MMC_Stop"></a><a name="Topic49"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MMC_Stop</div>
 <div id="NDPrototype49" class="NDPrototype"><div class="PSection PPlainSection">MMC_Stop()</div></div>
 <div class="CBody"><p>Change MCS (Motion Control State) to Stop</p><p>Instruct the receiving device to stop. Stops Play, Record, FastForward and Rewind.</p><div class="CHeading">Parameters</div><p>None</p><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Ctrl + Shift + NumpadDot = Stop</span><br />+^NumpadDot::<br />{<br />    MIDI.MMC_Stop()<br />}</pre></div>
</div>

<a name="MMC_Play"></a><a name="Topic50"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MMC_Play</div>
 <div id="NDPrototype50" class="NDPrototype"><div class="PSection PPlainSection">MMC_Play()</div></div>
 <div class="CBody"><p>Change MCS (Motion Control State) to Play</p><p>Instruct the receiving device to start playing.</p><div class="CHeading">Parameters</div><p>None</p><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Ctrl + Shift + NumEnter = Play</span><br />+^NumpadEnter::<br />{<br />    MIDI.MMC_Play()<br />}</pre></div>
</div>

<a name="MMC_DPlay"></a><a name="Topic51"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MMC_DPlay</div>
 <div id="NDPrototype51" class="NDPrototype"><div class="PSection PPlainSection">MMC_DPlay()</div></div>
 <div class="CBody"><p>Change MCS (Motion Control State) to Deferred Play</p><p>This command is almost identical to <a href="../index.html#File:MIDIv2.doc.ahk:MMC_Play" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,50);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MMC_Play</a> with the exception that if the target device is in the process of locating. Play will then start when locate is completed.</p><div class="CHeading">Parameters</div><p>None</p><div class="CHeading">See Also</div><p><a href="../index.html#File:MIDIv2.doc.ahk:MMC_Play" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,50);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MMC_Play</a>, &lt;MMC_setTimeCode&gt;</p></div>
</div>

<a name="MMC_FF"></a><a name="Topic52"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MMC_FF</div>
 <div id="NDPrototype52" class="NDPrototype"><div class="PSection PPlainSection">MMC_FF()</div></div>
 <div class="CBody"><p>Change MCS to Fast Forward</p><p>Instruct the receiving device to fast forward. The device will fast forward until a stop command is received.</p><div class="CHeading">Parameters</div><p>None</p><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Ctrl + Shift + NumpadPlus = FF</span><br />+^NumpadAdd::<br />{<br />    MIDI.MMC_FF()<br />    Hotkey <span class="SHString">&quot;+^NumpadAdd&quot;</span>, <span class="SHString">&quot;Off&quot;</span>    <span class="SHComment">; Prevent key repeat</span><br />}<br />+^NumpadAdd Up::<br />{<br />    MIDI.MMC_Stop()<br />    Hotkey <span class="SHString">&quot;+^NumpadAdd&quot;</span>, <span class="SHString">&quot;On&quot;</span><br />}</pre></div>
</div>

<a name="MMC_Rewind"></a><a name="Topic53"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MMC_Rewind</div>
 <div id="NDPrototype53" class="NDPrototype"><div class="PSection PPlainSection">MMC_Rewind()</div></div>
 <div class="CBody"><p>Change MCS to Rewind</p><p>Instruct the receiving device to rewind. The device will rewind until a stop command is received.</p><div class="CHeading">Parameters</div><p>None</p><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Ctrl + Shift + NumpadMinus = FF</span><br />+^NumpadSub::<br />{<br />    MIDI.MMC_Rewind()<br />    Hotkey <span class="SHString">&quot;+^NumpadSub&quot;</span>, <span class="SHString">&quot;Off&quot;</span>    <span class="SHComment">; Prevent key repeat</span><br />}<br />+^NumpadSub Up::<br />{<br />    MIDI.MMC_Stop()<br />    Hotkey <span class="SHString">&quot;+^NumpadSub&quot;</span>, <span class="SHString">&quot;On&quot;</span><br />}</pre></div>
</div>

<a name="MMC_Record"></a><a name="Topic54"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MMC_Record</div>
 <div id="NDPrototype54" class="NDPrototype"><div class="PSection PPlainSection">MMC_Record()</div></div>
 <div class="CBody"><p>Change MCS to Record Strobe</p><p>Instruct the receiving device to start recording on all record enabled tracks.</p><p>If the target device is in Stop state, upon receiving this command it should start recording right away (Record+Play). This command can also be sent if the target device is already in a Play state upon which it will act as a Punch In command.</p><p>If the target device already is in a Record state, upon receiving this command recording will cease and the device will continue in a Play state—effectively act as a Punch Out command.</p><div class="CHeading">Parameters</div><p>None</p><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Ctrl + Shift + NumpadMultiply = FF</span><br />+^NumpadMult::<br />{<br />    MIDI.MMC_Record()<br />}</pre></div>
</div>

<a name="MMC_RecordExit"></a><a name="Topic55"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MMC_RecordExit</div>
 <div id="NDPrototype55" class="NDPrototype"><div class="PSection PPlainSection">MMC_RecordExit()</div></div>
 <div class="CBody"><p>End recording on all recording tracks</p><p>Effectively a Punch Out command. The target device will switch from record to play.</p><div class="CHeading">Parameters</div><p>None</p><div class="CHeading">See Also</div><p><a href="../index.html#File:MIDIv2.doc.ahk:MMC_Record" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,54);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MMC_Record</a></p></div>
</div>

<a name="MMC_RecordPause"></a><a name="Topic56"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MMC_RecordPause</div>
 <div id="NDPrototype56" class="NDPrototype"><div class="PSection PPlainSection">MMC_RecordPause()</div></div>
 <div class="CBody"><p>Set target device to a ready-to-record state</p><p>This command requires that a &lt;MC_Pause&gt; command was send beforehand. If the target device is not in a MCS Pause state, this command will be ignored.</p><div class="CHeading">Parameters</div><p>None</p><div class="CHeading">See Also</div><p><a href="../index.html#File:MIDIv2.doc.ahk:MMC_Record" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,54);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MMC_Record</a>, <a href="../index.html#File:MIDIv2.doc.ahk:MMC_Pause" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,57);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MMC_Pause</a></p></div>
</div>

<a name="MMC_Pause"></a><a name="Topic57"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MMC_Pause</div>
 <div id="NDPrototype57" class="NDPrototype"><div class="PSection PPlainSection">MMC_Pause()</div></div>
 <div class="CBody"><p>Instruct the target device to stop as soon as possible</p><p>Similar to MMC_RecordPause, this command should set the target device in a state that minimizes the time to reach a Play state.</p><p>If the target device is in a Recording state when it receives a Pause command, it should enter a Record-Pause state.</p><div class="CHeading">Parameters</div><p>None</p><div class="CHeading">See Also</div><p><a href="../index.html#File:MIDIv2.doc.ahk:MMC_Play" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,50);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MMC_Play</a>, <a href="../index.html#File:MIDIv2.doc.ahk:MMC_RecordPause" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,56);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MMC_RecordPause</a></p></div>
</div>

<a name="MMC_Locate"></a><a name="Topic58"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MMC_Locate</div>
 <div id="NDPrototype58" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="5" data-NarrowColumnCount="4"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/5" style="grid-area:1/1/2/2">MMC_Locate(</div><div class="PModifierQualifier InFirstParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3"><span class="SHKeyword">string</span> or&nbsp;</div><div class="PType" data-WideGridArea="1/3/2/4" data-NarrowGridArea="2/2/3/3" style="grid-area:1/3/2/4"><span class="SHKeyword">int</span>[]&nbsp;</div><div class="PName InLastParameterColumn" data-WideGridArea="1/4/2/5" data-NarrowGridArea="2/3/3/4" style="grid-area:1/4/2/5">timeCode</div><div class="PAfterParameters" data-WideGridArea="1/5/2/6" data-NarrowGridArea="3/1/4/5" style="grid-area:1/5/2/6">)</div></div></div></div>
 <div class="CBody"><p>Locate to new Time Code</p><p>Set a Time Code value and initiate the MCP (Motion Control Process) command Locate.</p><p>The single argument can be sent either as a string or as an array of int. The Time code format is:</p><pre class="CCode"><span class="SHString">&quot;hh:mm:ss:ff&quot;</span></pre><p>where:</p><table class="CDefinitionList"><tr><td class="CDLEntry">hh</td><td class="CDLDefinition"><p>Hours 		- 2 digits (00-23)</p></td></tr><tr><td class="CDLEntry">mm</td><td class="CDLDefinition"><p>Minutes	- 2 digits (00-59)</p></td></tr><tr><td class="CDLEntry">ss</td><td class="CDLDefinition"><p>Seconds	- 2 digits (00-59)</p></td></tr><tr><td class="CDLEntry">ff</td><td class="CDLDefinition"><p>Frames		- 2 digits (00-30)¹</p></td></tr></table><p>¹The max value for Frames depends on the FPS setting of the target device</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">timeCode<div class="CDLParameterType"><span class="SHKeyword">string</span> or <span class="SHKeyword">int</span>[]</div></td><td class="CDLDefinition"><p>Time Code to move to</p></td></tr></table><div class="CHeading">Example</div><pre class="CCode"><span class="SHComment">; Using a string value</span><br />TC_String := <span class="SHString">&quot;00:02:44:20&quot;</span><br />MIDI.MMC_Locate(TC_String)<br /><br /><span class="SHComment">; Using an array</span><br />TC_Array := [<span class="SHNumber">0</span>, <span class="SHNumber">2</span>, <span class="SHNumber">44</span>, <span class="SHNumber">20</span>]<br />MIDI.MMC_Locate(TC_Array)</pre></div>
</div>

<a name="MMC_RequestTimeCode"></a><a name="Topic59"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MMC_RequestTimeCode</div>
 <div id="NDPrototype59" class="NDPrototype"><div class="PSection PPlainSection">MMC_RequestTimeCode()</div></div>
 <div class="CBody"><p>Request current Time Code and Frame Rate</p><p>The response from the target device will trigger the &lt;TCFull&gt; callback function.</p><div class="CHeading">Parameters</div><p>None</p><div class="CHeading">See Also</div><p>&lt;TCFull&gt;</p></div>
</div>

<a name="Callbacks(2)"></a><a name="Topic60"></a><div class="CTopic TGroup LAutoHotKey">
 <div class="CTitle">Callbacks [2]</div>
</div>

<a name="TC_Full"></a><a name="Topic61"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">TC_Full</div>
 <div id="NDPrototype61" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="3" data-NarrowColumnCount="2"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/3" style="grid-area:1/1/2/2">TC_Full(</div><div class="PName InFirstParameterColumn InLastParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3">timeCode</div><div class="PAfterParameters" data-WideGridArea="1/3/2/4" data-NarrowGridArea="3/1/4/3" style="grid-area:1/3/2/4">)</div></div></div></div>
 <div class="CBody"><p>Receive current Time Code</p><p>This callback is typically triggered when the device enters a Stop state or after a locating.</p><p>It can also be triggered by calling the <a href="../index.html#File:MIDIv2.doc.ahk:MMC_RequestTimeCode" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,59);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MMC_requestTimeCode</a> function.</p><div class="CHeading">timeCode</div><table class="CDefinitionList"><tr><td class="CDLEntry">hours</td><td class="CDLDefinition"><p>(0-23)</p></td></tr><tr><td class="CDLEntry">minutes</td><td class="CDLDefinition"><p>(0-59)</p></td></tr><tr><td class="CDLEntry">seconds</td><td class="CDLDefinition"><p>(0-59)</p></td></tr><tr><td class="CDLEntry">frames</td><td class="CDLDefinition"><p>(0-30)¹</p></td></tr><tr><td class="CDLEntry">frameRateCode</td><td class="CDLDefinition"><p>(0-3)²</p></td></tr><tr><td class="CDLEntry">frameRate</td><td class="CDLDefinition"><p>One of the 4 frame rates as a float number</p></td></tr></table><p>¹The max value for Frames depends on the FPS setting of the target device</p><p>²Frame rate codes are:</p><p>0 = 24 FPS</p><p>1 = 25 FPS</p><p>2 = 29.97 FPS (or 30 FPS Drop Frame)</p><p>3 = 30 FPS</p><div class="CHeading">Example</div><pre class="CCode">MidiInTCFull(timeCode) {<br />    <span class="SHComment">; Create a TC string</span><br />    TCString := Format(<span class="SHString">&quot;:02i&quot;</span>, timeCode.hours) . <span class="SHString">&quot;:&quot;</span><br />    TCString .= Format(<span class="SHString">&quot;:02i&quot;</span>, timeCode.minutes) . <span class="SHString">&quot;:&quot;</span><br />    TCString .= Format(<span class="SHString">&quot;:02i&quot;</span>, timeCode.seconds) . <span class="SHString">&quot;:&quot;</span><br />    TCString .= Format(<span class="SHString">&quot;:02i&quot;</span>, timeCode.frames)<br /><br />    MsgBox(<span class="SHString">&quot;Time Code:`n&quot;</span> . TCString . <span class="SHString">&quot;`nFrame rate:`n&quot;</span> . timeCode.frameRate)<br />}</pre></div>
</div>

<a name="MCR_Stop"></a><a name="Topic62"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MCR_Stop</div>
 <div id="NDPrototype62" class="NDPrototype"><div class="PSection PPlainSection">MCR_Stop()</div></div>
 <div class="CBody"><p>Current Motion Control State (MCS) is Stop</p><p>This MCR (Machine Control Response) is the first of several response messages that annouce the target device's control state.</p><p>This and the following state callbacks are triggered whenever the device's status changes, be it remotely or localy.</p><div class="CHeading">Parameters</div><p>None</p></div>
</div>

<a name="MCR_Play"></a><a name="Topic63"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MCR_Play</div>
 <div id="NDPrototype63" class="NDPrototype"><div class="PSection PPlainSection">MCR_Play()</div></div>
 <div class="CBody"><p>MCS is Play</p><div class="CHeading">Parameters</div><p>None</p></div>
</div>

<a name="MCR_FF"></a><a name="Topic64"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MCR_FF</div>
 <div id="NDPrototype64" class="NDPrototype"><div class="PSection PPlainSection">MCR_FF()</div></div>
 <div class="CBody"><p>MCS is Fast Forward</p><div class="CHeading">Parameters</div><p>None</p></div>
</div>

<a name="MCR_Rewind"></a><a name="Topic65"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MCR_Rewind</div>
 <div id="NDPrototype65" class="NDPrototype"><div class="PSection PPlainSection">MCR_Rewind()</div></div>
 <div class="CBody"><p>MCS is Rewind</p><div class="CHeading">Parameters</div><p>None</p></div>
</div>

<a name="MCR_Pause"></a><a name="Topic66"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MCR_Pause</div>
 <div id="NDPrototype66" class="NDPrototype"><div class="PSection PPlainSection">MCR_Pause()</div></div>
 <div class="CBody"><p>MCS is Pause</p><div class="CHeading">Parameters</div><p>None</p></div>
</div>

<a name="MCR_VPlay"></a><a name="Topic67"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MCR_VPlay</div>
 <div id="NDPrototype67" class="NDPrototype"><div class="PSection PPlainSection">MCR_VPlay()</div></div>
 <div class="CBody"><p>MCS is Variable Play</p><div class="CHeading">Parameters</div><p>None</p></div>
</div>

<a name="MCR_Search"></a><a name="Topic68"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MCR_Search</div>
 <div id="NDPrototype68" class="NDPrototype"><div class="PSection PPlainSection">MCR_Search()</div></div>
 <div class="CBody"><p>MCS is Search</p><div class="CHeading">Parameters</div><p>None</p></div>
</div>

<a name="MCR_Shuttle"></a><a name="Topic69"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MCR_Shuttle</div>
 <div id="NDPrototype69" class="NDPrototype"><div class="PSection PPlainSection">MCR_Shuttle()</div></div>
 <div class="CBody"><p>MCS is Shuttle</p><div class="CHeading">Parameters</div><p>None</p></div>
</div>

<a name="MCR_Step"></a><a name="Topic70"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MCR_Step</div>
 <div id="NDPrototype70" class="NDPrototype"><div class="PSection PPlainSection">MCR_Step()</div></div>
 <div class="CBody"><p>MCS is Step</p><div class="CHeading">Parameters</div><p>None</p></div>
</div>

<a name="MCR_RecordOff"></a><a name="Topic71"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MCR_RecordOff</div>
 <div id="NDPrototype71" class="NDPrototype"><div class="PSection PPlainSection">MCR_RecordOff()</div></div>
 <div class="CBody"><p>Record Mode is off</p><p>Indicates that the target device has stopped recording</p><div class="CHeading">Parameters</div><p>None</p><div class="CHeading">See Also</div><p><a href="../index.html#File:MIDIv2.doc.ahk:MCR_RecordOn" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,72);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MCR_RecordOn</a>, <a href="../index.html#File:MIDIv2.doc.ahk:MMC_Record" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,54);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MMC_Record</a>, <a href="../index.html#File:MIDIv2.doc.ahk:MMC_RecordExit" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,55);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MMC_RecordExit</a></p></div>
</div>

<a name="MCR_RecordOn"></a><a name="Topic72"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MCR_RecordOn</div>
 <div id="NDPrototype72" class="NDPrototype"><div class="PSection PPlainSection">MCR_RecordOn()</div></div>
 <div class="CBody"><p>Record Mode is on</p><p>Indicates that the target device has started recording</p><div class="CHeading">Parameters</div><p>None</p><div class="CHeading">See Also</div><p><a href="../index.html#File:MIDIv2.doc.ahk:MCR_RecordOff" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,71);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MCR_RecordOff</a>, <a href="../index.html#File:MIDIv2.doc.ahk:MMC_Record" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,54);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MMC_Record</a></p></div>
</div>

<a name="MMC_SysEx"></a><a name="Topic91"></a><div class="CTopic TFunction LAutoHotKey">
 <div class="CTitle">MMC_SysEx</div>
 <div id="NDPrototype91" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="3" data-NarrowColumnCount="2"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/3" style="grid-area:1/1/2/2">MMC_SysEx(</div><div class="PName InFirstParameterColumn InLastParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3">sysExEvent</div><div class="PAfterParameters" data-WideGridArea="1/3/2/4" data-NarrowGridArea="3/1/4/3" style="grid-area:1/3/2/4">)</div></div></div></div>
 <div class="CBody"><p>Machine Control Response or State in a SysEx object</p><p>This event is raised whenever a MMC or MTC related message is received as a SysEx message.</p><p>In MIDIv2, it includes all MMC and TC related messages with the exception of running Time Code messages (<a href="../index.html#File:MIDIv2.doc.ahk:TC_RunningFull" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,74);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >TC_RunningFull</a>).</p><p>It includes all SysEx messages that begins with &quot;F0 F7&quot;.</p><p>This event can be used to capture any states or procedures not already covered by the above callbacks.</p><p>The MCC_SysEx callback is triggered even if a callback for a specific MCC/TC event is defined.</p><p>MCC_SysEx requires the class parameters <a href="../index.html#File:MIDIv2.doc.ahk:MMC_enabled" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,45);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >MMC_enabled</a> and/or <a href="../index.html#File:MIDIv2.doc.ahk:TC_enabled" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,46);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >TC_enabled</a> to be true.</p><div class="CHeading">sysExEvent</div><table class="CDefinitionList"><tr><td class="CDLEntry">ArrHex</td><td class="CDLDefinition"><p>Array of each SysEx byte formatted as hexadecimal</p><p>(First element is &quot;F0&quot; and the last is &quot;F7&quot;)</p></td></tr><tr><td class="CDLEntry">ArrDec</td><td class="CDLDefinition"><p>Array of each SysEx byte formatted as decimal integer</p></td></tr><tr><td class="CDLEntry">String</td><td class="CDLDefinition"><p>SysEx message as one string, space delimited</p></td></tr><tr><td class="CDLEntry">Size</td><td class="CDLDefinition"><p>Total number of bytes in the message</p></td></tr></table><div class="CHeading">See Also</div><p><a href="../index.html#File:MIDIv2.doc.ahk:SysEx" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,82);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >SysEx</a></p></div>
</div>

<a name="TC_RunningFull"></a><a name="Topic74"></a><div class="CTopic TFunction LAutoHotKey last">
 <div class="CTitle">TC_RunningFull</div>
 <div id="NDPrototype74" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><div class="PParameterCells" data-WideColumnCount="3" data-NarrowColumnCount="2"><div class="PBeforeParameters" data-WideGridArea="1/1/2/2" data-NarrowGridArea="1/1/2/3" style="grid-area:1/1/2/2">TC_RunningFull(</div><div class="PName InFirstParameterColumn InLastParameterColumn" data-WideGridArea="1/2/2/3" data-NarrowGridArea="2/1/3/2" style="grid-area:1/2/2/3">MidiEvent</div><div class="PAfterParameters" data-WideGridArea="1/3/2/4" data-NarrowGridArea="3/1/4/3" style="grid-area:1/3/2/4">)</div></div></div></div>
 <div class="CBody"><p>Time Code from running transport</p><p>This callback is triggered when the transport of the target device is running in either a Play or Record state.</p><p>When the device is running, it send out a partial time code message once every quarter frame. Each message contains 4 bits of Time Code data and it takes 8 of these messages to create a full Time Code value.&nbsp; As such, TC_RunningFull is triggered once every 2nd frame.</p><div class="CHeading">MidiEvent</div><table class="CDefinitionList"><tr><td class="CDLEntry">Hours</td><td class="CDLDefinition"><p>(0-23)</p></td></tr><tr><td class="CDLEntry">Minutes</td><td class="CDLDefinition"><p>(0-59)</p></td></tr><tr><td class="CDLEntry">Seconds</td><td class="CDLDefinition"><p>(0-59)</p></td></tr><tr><td class="CDLEntry">Frames</td><td class="CDLDefinition"><p>(0-30)¹</p></td></tr><tr><td class="CDLEntry">FrameRateCode</td><td class="CDLDefinition"><p>(0-3)²</p></td></tr><tr><td class="CDLEntry">FrameRate</td><td class="CDLDefinition"><p>One of the 4 frame rates as a float number</p></td></tr></table><p>¹The max value for frames depends on the FPS setting of the target device</p><p>²Frame rate codes are:</p><p>0 = 24 FPS</p><p>1 = 25 FPS</p><p>2 = 29.97 FPS (or 30 FPS Drop Frame)</p><p>3 = 30 FPS</p><div class="CHeading">See Also</div><p><a href="../index.html#File:MIDIv2.doc.ahk:SysEx" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,82);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >SysEx</a></p></div>
</div>

</body></html>